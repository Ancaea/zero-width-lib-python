{"version":3,"file":"zero-width-lib.umd.js","sources":["../src/zero-width-lib.js"],"sourcesContent":["const { performance } = require('perf_hooks');\n\nconst zeroWidthNonJoiner = '‌';\nconst zeroWidthJoiner = '‍';\nconst zeroWidthSpace = '​';\nconst zeroWidthNoBreakSpace = '﻿';\nconst leftToRightMark = '‎';\nconst rightToLeftMark = '‏';\n\nexport const zeroWidthDict = {\n\tleftToRightMark,\n\trightToLeftMark,\n\tzeroWidthNonJoiner,\n\tzeroWidthJoiner,\n\tzeroWidthNoBreakSpace,\n\tzeroWidthSpace\n};\n\nconst Quinary2ZeroMap = Object.keys(zeroWidthDict).map(key => zeroWidthDict[key]);\nconst Zero2QuinaryMap = \n\tQuinary2ZeroMap.reduce((acc, cur, index) => {\n\t\tacc[cur] = '' + index;\n\t\treturn acc;\n\t}, {});\n\nexport function t2z(t) {\n\tlet z = '';\n\tfor (let i = 0 ; i < t.length ; i++) {\n\t\tconst base10 = t.codePointAt(i);\n\t\tconst base5 = base10.toString(5);\n\t\tlet zero = '';\n\t\tfor (let j = 0 ; j < base5.length ; j++) {\n\t\t\t// quinary to zero width chars\n\t\t\t// may be able to extend to other base\n\t\t\tzero += Quinary2ZeroMap[+base5.charAt(j)];\n\t\t}\n\t\t// skip low surrogate\n\t\ti = base10 < 0x10000 ? i : i + 1;\n\t\tz += i === t.length - 1 ? zero : zero + zeroWidthSpace;\n\t}\n\treturn z;\n}\n\nexport function z2t(z) {\n\tlet t = '';\n\t// return empty string when input is empty\n\tif (z.length === 0) {\n\t\treturn t;\n\t}\n\tconst chars = z.split(zeroWidthSpace);\n\tfor (let i = 0 ; i < chars.length ; i++) {\n\t\tlet base5 = '';\n\t\tfor (let j = 0 ; j < chars[i].length ; j++) {\n\t\t\tbase5 += Zero2QuinaryMap[chars[i].charAt(j)];\n\t\t}\n\t\tt += String.fromCodePoint(parseInt(base5, 5));\n\t}\n\treturn t;\n}\n\nexport function encode(vis, hid) {\n\tlet e = '';\n\t// convert hidden text to zero width chars\n\tconst hid2z = t2z(hid);\n\t// if visible text is empty\n\t// return zero width chars directly\n\tif (vis.length === 0) {\n\t\treturn hid2z;\n\t}\n\t// otherwise insert zero width chars\n\t// after the first character\n\t// try to prevent user from not copying zero width chars\n\tlet isAdded = false;\n\tfor (const ch of vis) {\n\t\te += ch;\n\t\tif (!isAdded) {\n\t\t\te += hid2z;\n\t\t\tisAdded = true;\n\t\t}\n\t}\n\treturn e;\n}\n\nexport function extract(t) {\n\tlet vis = '';\n\tlet hid = '';\n\tfor (const ch of t) {\n\t\tif (Zero2QuinaryMap[ch]) {\n\t\t\thid += ch;\n\t\t} else {\n\t\t\tvis += ch;\n\t\t}\n\t}\n\treturn {\n\t\tvis,\n\t\thid\n\t}\n}\n\nexport function decode(vis) {\n\t// decode a visible text\n\treturn z2t(extract(vis).hid);\n}\n\nexport function split(t) {\n\t// split text with zero width chars\n\tlet s = '';\n\tfor (const ch of t) {\n\t\ts += ch;\n\t\ts += zeroWidthSpace;\n\t}\n\treturn s;\n}\n"],"names":["require","zeroWidthSpace","zeroWidthDict","Quinary2ZeroMap","Object","keys","map","key","Zero2QuinaryMap","reduce","acc","cur","index","t2z","t","let","z","i","length","const","base10","codePointAt","base5","toString","zero","j","charAt","z2t","chars","split","String","fromCodePoint","parseInt","extract","vis","hid","ch","e","hid2z","isAdded","s"],"mappings":"kLAAwBA,QAAQ,kBAI1BC,EAAiB,IAKVC,mBAHW,oBACA,uBALG,oBACH,0BAEM,wBAU7BD,GAGKE,EAAkBC,OAAOC,KAAKH,GAAeI,aAAIC,UAAOL,EAAcK,KACtEC,EACLL,EAAgBM,gBAAQC,EAAKC,EAAKC,GAEjC,OADAF,EAAIC,GAAO,GAAKC,EACTF,OAGF,SAASG,EAAIC,GAEnB,IADAC,IAAIC,EAAI,GACCC,EAAI,EAAIA,EAAIH,EAAEI,OAASD,IAAK,CAIpC,IAHAE,IAAMC,EAASN,EAAEO,YAAYJ,GACvBK,EAAQF,EAAOG,SAAS,GAC1BC,EAAO,GACFC,EAAI,EAAIA,EAAIH,EAAMJ,OAASO,IAGnCD,GAAQrB,GAAiBmB,EAAMI,OAAOD,IAIvCT,IADAC,EAAIG,EAAS,MAAUH,EAAIA,EAAI,KACpBH,EAAEI,OAAS,EAAIM,EAAOA,EAAOvB,EAEzC,OAAOe,EAGD,SAASW,EAAIX,GACnBD,IAAID,EAAI,GAER,GAAiB,IAAbE,EAAEE,OACL,OAAOJ,EAGR,IADAK,IAAMS,EAAQZ,EAAEa,MAAM5B,GACbgB,EAAI,EAAIA,EAAIW,EAAMV,OAASD,IAAK,CAExC,IADAF,IAAIO,EAAQ,GACHG,EAAI,EAAIA,EAAIG,EAAMX,GAAGC,OAASO,IACtCH,GAASd,EAAgBoB,EAAMX,GAAGS,OAAOD,IAE1CX,GAAKgB,OAAOC,cAAcC,SAASV,EAAO,IAE3C,OAAOR,EA0BD,SAASmB,EAAQnB,GAGvB,IAFAC,IAAImB,EAAM,GACNC,EAAM,SACOrB,kBAAG,CAAfK,IAAMiB,OACN5B,EAAgB4B,GACnBD,GAAOC,EAEPF,GAAOE,EAGT,WACCF,MACAC,8CAnCK,SAAgBD,EAAKC,GAC3BpB,IAAIsB,EAAI,GAEFC,EAAQzB,EAAIsB,GAGlB,GAAmB,IAAfD,EAAIhB,OACP,OAAOoB,EAMR,IADAvB,IAAIwB,GAAU,QACGL,kBAChBG,QACKE,IACJF,GAAKC,EACLC,GAAU,GAGZ,OAAOF,wBAmBD,SAAgBH,GAEtB,OAAOP,EAAIM,EAAQC,GAAKC,cAGlB,SAAerB,GAGrB,IADAC,IAAIyB,EAAI,SACS1B,kBAChB0B,QACAA,GAAKvC,EAEN,OAAOuC"}